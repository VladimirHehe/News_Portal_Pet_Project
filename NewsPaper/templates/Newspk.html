
{% extends 'flatpages/default.html' %}
{% load censor_filter %}
{% block title %}
Post
{% endblock title %}

{% block content %}

{{post.header| check_bad_words}}


<h5 style="text-align: left;"> Категории:
    {% for category in post.category.all %}
        {{ category }}{% if not forloop.last %}, {% endif %}
    {% empty %}
        Нет категорий
    {% endfor %}
</h5>

<h5 style="text-align: left;"> Дата публикации: {{post.date_created|date:"d.m.Y"}}</h5>

{% if user.is_authenticated %}
    {% for category in categories %}
        {% if not category.is_subscribed %}
            <div style="text-align: left;">
                <button><a href="{% url 'subscribe_to_category' category.category.id %}">Подпишитесь на категорию "{{ category.category }}"</a></button>
            </div>
        {% else %}
            <span style="font-size: 0.8em; color: #666; display: block; float: left;">Вы уже подписаны на категорию: "{{ category.category }}"</span>
        {% endif %}
    {% endfor %}
{% else %}
    <span style="font-size: 0.8em; color: #666; display: block; float: left;">Чтобы подписаться на категорию, пожалуйста, авторизуйтесь!</span>
{% endif %}

<hr style="clear: both;">
<h4> {{post.text | check_bad_words }}</h4>

<hr>

<h3 style="margin-bottom: 10px;">Все комментарии</h3>
<ul style="list-style: none; padding: 0; margin: 0;">
    {% for comment in post.comment_set.all %}
        <li style="margin-bottom: 10px;">
            {{ comment.text|check_bad_words }}
            (likes: {{ comment.rating }})
        </li>
    {% empty %}

        <li style="color: #999;">Эту новость ещё никто не прокомментировал</li>
    {% endfor %}

</ul>
<form method="post" action="{% url 'comment_form' post.id %}">
    {% csrf_token %}
    <textarea name="comment" cols="40" rows="5" class="form-control"></textarea>
    <button type="submit" class="btn btn-primary btn-sm">
        <i class="fas fa-comment"></i> Добавить
    </button>
</form>

{% endblock content %}